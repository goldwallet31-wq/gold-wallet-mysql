# دليل نظام المصادقة - Gold Wallet

## نظرة عامة
تم إضافة نظام مصادقة احترافي لتطبيق محفظة الذهب يتضمن:
- صفحة تسجيل دخول احترافية
- نظام إدارة الجلسات
- حماية الصفحات من الوصول بدون تسجيل دخول
- زر تسجيل الخروج

## الملفات الجديدة

### 1. `app/login/page.tsx`
صفحة تسجيل الدخول الاحترافية التي تتضمن:
- نموذج تسجيل دخول احترافي
- التحقق من صحة البيانات
- عرض/إخفاء كلمة المرور
- رسائل خطأ واضحة
- بيانات تجريبية للاختبار

**بيانات تجريبية:**
- البريد الإلكتروني: `demo@gold.com`
- كلمة المرور: `1234`

### 2. `hooks/use-auth.ts`
Hook مخصص للتحقق من حالة المصادقة:
- التحقق من تسجيل الدخول عند تحميل الصفحة
- إدارة بيانات المستخدم
- وظيفة تسجيل الخروج
- حالة التحميل

### 3. `middleware.ts`
ملف middleware للتحكم في الوصول:
- السماح بالوصول إلى صفحة تسجيل الدخول بدون تسجيل
- السماح بالوصول إلى API routes
- إعادة التوجيه التلقائي للصفحات المحمية

## التعديلات على الملفات الموجودة

### `app/page.tsx` (الصفحة الرئيسية)
- إضافة استيراد `useAuth` hook
- إضافة التحقق من تسجيل الدخول
- إضافة شاشة تحميل أثناء التحقق
- إضافة زر تسجيل الخروج في الـ Header

### `app/add-purchase/page.tsx`
- إضافة استيراد `useAuth` hook
- إضافة التحقق من تسجيل الدخول
- إضافة شاشة تحميل

### `app/analysis/page.tsx`
- إضافة استيراد `useAuth` hook
- إضافة التحقق من تسجيل الدخول
- إضافة شاشة تحميل
- تحديث useEffect لتحميل البيانات فقط بعد التحقق من المصادقة

## كيفية الاستخدام

### تسجيل الدخول
1. انتقل إلى صفحة تسجيل الدخول: `http://localhost:3001/login`
2. أدخل البريد الإلكتروني أو اسم المستخدم
3. أدخل كلمة المرور
4. اضغط على زر "تسجيل الدخول"
5. سيتم إعادة التوجيه إلى الصفحة الرئيسية

### تسجيل الخروج
1. اضغط على زر "تسجيل الخروج" في الـ Header
2. سيتم حذف بيانات الجلسة
3. سيتم إعادة التوجيه إلى صفحة تسجيل الدخول

### الصفحات المحمية
الصفحات التالية محمية وتتطلب تسجيل دخول:
- `/` (الصفحة الرئيسية)
- `/add-purchase` (إضافة شراء)
- `/analysis` (التحليل)

## تخزين البيانات

البيانات يتم تخزينها في `localStorage`:
- `isLoggedIn`: حالة تسجيل الدخول (true/false)
- `currentUser`: بيانات المستخدم (JSON)
  - `email`: البريد الإلكتروني
  - `password`: كلمة المرور
  - `loginTime`: وقت تسجيل الدخول

## ملاحظات أمان

⚠️ **تنبيه أمان:**
- هذا النظام يستخدم `localStorage` وهو غير آمن للبيانات الحساسة
- كلمات المرور يتم تخزينها بدون تشفير
- للاستخدام الإنتاجي، يجب استخدام:
  - Backend API للمصادقة
  - JWT tokens أو sessions
  - تشفير البيانات الحساسة
  - HTTPS فقط

## الاختبار

### اختبار تسجيل الدخول
```
1. افتح http://localhost:3001/login
2. أدخل: demo@gold.com / 1234
3. تحقق من إعادة التوجيه إلى الصفحة الرئيسية
```

### اختبار الحماية
```
1. افتح http://localhost:3001 بدون تسجيل دخول
2. يجب أن يتم إعادة التوجيه إلى صفحة تسجيل الدخول
```

### اختبار تسجيل الخروج
```
1. سجل دخول بنجاح
2. اضغط على زر "تسجيل الخروج"
3. تحقق من إعادة التوجيه إلى صفحة تسجيل الدخول
```

## التطوير المستقبلي

يمكن تحسين النظام بـ:
- إضافة تسجيل حساب جديد
- إضافة استرجاع كلمة المرور
- إضافة المصادقة الثنائية
- إضافة تسجيل الدخول عبر وسائل التواصل
- إضافة إدارة الملفات الشخصية

